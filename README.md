# DataInsightBot - 智能线性回归分析系统

一个专为数据分析初学者设计的智能线性回归分析工具。支持分类变量、交互效应分析，通过自然语言查询自动生成专业的统计分析报告和可视化图表。

## 主要特性

### 智能分析
- **自然语言查询** - 用中文描述你的分析需求
- **自动变量识别** - 智能区分分类变量和数值变量
- **交互效应分析** - 默认考虑变量间的交互作用
- **统计显著性检验** - 自动计算p值和置信区间

### 专业回归分析
- **简单/多元线性回归** - 支持单个或多个预测变量
- **分类变量处理** - 自动进行one-hot编码和参考类别设定
- **模型性能评估** - R²、RMSE、MAE等专业指标
- **完整回归方程** - 显示数学表达式方便应用

### 丰富可视化
- **散点图** - 变量关系和预测效果展示
- **箱线图** - 分类变量的分布分析  
- **残差分析** - 模型假设验证
- **分组图表** - 按分类变量分组的趋势分析

## 快速开始

### 系统要求
- Python 3.8 或更高版本
- Node.js 16 或更高版本
- 现代浏览器（Chrome、Firefox、Safari、Edge）

### 安装步骤

#### 1. 下载项目
```bash
# 如果从GitHub下载
git clone <your-repository-url>
cd v1timeout

# 或者解压下载的文件包
unzip v1timeout.zip
cd v1timeout
```

#### 2. 设置Python后端环境
```bash
# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
# macOS/Linux:
source venv/bin/activate
# Windows:
venv\Scripts\activate

# 安装Python依赖
pip install -r requirements.txt
```

#### 3. 设置前端环境
```bash
# 进入前端目录
cd frontend

# 安装Node.js依赖（可能需要几分钟）
npm install

# 返回项目根目录
cd ..
```

#### 4. 配置API密钥（必需）
```bash
# 复制环境变量模板
cp env_template.txt .env

nano .env
# 编辑.env文件，添加你的LLM API密钥
# 支持OpenAI、DeepSeek、Claude等
```

**重要**：必须配置至少一个LLM API密钥，系统才能正常工作。

#### 5. 启动应用
```bash
# 启动后端服务
python app.py
```

在新的终端窗口中：
```bash
# 进入前端目录并启动
cd frontend
npm start
```

#### 6. 开始使用
- 前端界面：http://localhost:3000
- 后端API：http://localhost:8000
- API文档：http://localhost:8000/docs

## 使用指南

### 数据准备
支持的文件格式：
- **Excel文件** (.xlsx, .xls)
- **CSV文件** (.csv)
- **JSON文件** (.json)

数据要求：
- 至少包含2列（1个目标变量 + 1个预测变量）
- 建议样本数量 > 特征数量 × 10
- 目标变量必须是数值型

### 分析示例

#### 示例1：房价预测
```
数据：面积(数值)、房龄(数值)、位置(分类)、价格(目标)
查询："分析哪些因素影响房价"
结果：自动识别交互效应，如"市中心的大面积房屋价格更高"
```

#### 示例2：销售分析  
```
数据：广告费用(数值)、促销类型(分类)、季节(分类)、销售额(目标)
查询："预测销售额基于广告投入和促销策略"
结果：分析不同促销类型下广告效果的差异
```

#### 示例3：学生成绩
```
数据：学习时间(数值)、学习方法(分类)、年级(分类)、成绩(目标)  
查询："研究学习时间和方法对成绩的影响"
结果：发现不同年级学生的最优学习策略
```

### 结果解读

#### 模型摘要
- **R²值**：模型解释方差的比例，越接近1越好，但需警惕过拟合
- **系数**：按变量类型分组显示（数值变量、分类变量、交互项）
- **显著性**：*** p<0.001, ** p<0.01, * p<0.05
- **完整方程**：可直接用于预测计算的数学表达式

#### 可视化图表
- **预测vs实际**：点越接近对角线，预测越准确
- **残差分析**：应随机分布在0附近，无明显模式
- **变量关系**：展示各变量与目标变量的关系
- **分组对比**：不同类别下的趋势差异

##  配置说明

### LLM API配置
在`.env`文件中配置（选择一种即可）：

```env
# OpenAI (推荐)
OPENAI_API_KEY=sk-your-openai-key
OPENAI_BASE_URL=https://api.openai.com/v1

# DeepSeek (性价比高)
DEEPSEEK_API_KEY=your-deepseek-key  
DEEPSEEK_BASE_URL=https://api.deepseek.com

# Claude (Anthropic)
CLAUDE_API_KEY=your-claude-key
CLAUDE_BASE_URL=https://api.anthropic.com
```

### 分析参数
系统会自动：
- 识别分类变量（字符串类型或类别数<20的数值）
- 设置参考类别（按字母顺序的第一个类别）
- 生成交互项（除非明确说明"无交互"）
- 过滤显著性低的特征

## 故障排除

### 常见问题

**Q: 启动时报"ModuleNotFoundError"错误**
A: 确保已激活虚拟环境并安装了requirements.txt中的所有依赖

**Q: 前端无法启动**  
A: 检查Node.js版本是否>=16，并确保npm install成功完成

**Q: 分析时报API错误**
A: 检查.env文件中的API密钥是否正确配置

**Q: R²值过高（>0.99）**
A: 可能存在过拟合，检查样本数量是否足够，考虑减少特征数量

**Q: 图表显示异常**
A: 刷新浏览器页面，确保使用现代浏览器

### 性能建议
- 数据量 < 10万行时性能最佳
- 特征数量建议 < 20个
- 分类变量的类别数建议 < 10个

## 技术支持

如果遇到问题：
1. 检查控制台错误信息
2. 查看浏览器开发者工具
3. 确认API密钥配置正确
4. 验证数据格式符合要求

## 许可证

本项目基于MIT许可证开源，可自由使用和修改。

---

**DataInsightBot** -
